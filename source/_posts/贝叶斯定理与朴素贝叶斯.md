---
title: 贝叶斯定理与朴素贝叶斯
urlname: x3b36ht4
comments: true
mathjax: true
date: 2020-04-13 11:39:00
categories:
- 算法
tags:
- 算法
description: 先验概率，后验概率，条件概率，贝叶斯定理，朴素贝叶斯


---

### 1. 贝叶斯定理

#### 1.1 全概率公式

假设$B_1,B_2,…$是整个样本空间的一个划分，那么
$$
P(A)=P(A|B_1)*P(B_1)+P(A|B_2)*P(B_2)+...P(A|B_n)*P(B_n)=\sum{P(A|B_i)*P(B_i)}
$$
全概率公式就是分情况讨论，例子：
$$
P(明天化妆)=P(出门化妆概率){\cdot}P(出门概率)+P(不出门化妆概率){\cdot}P(不出门概率)
$$

#### 1.2 贝叶斯定理

简单形式
$$
P(B|A)=\frac{P(A|B)P(B)}{P(A)}
$$
结合全概率公式
$$
P(B_i|A)=\frac{P(A|B_i)P(B_i)}{\sum_{j=1}^{n}{P(A|B_j)*P(B_j)}}
$$
推导
$$
P(A,B)=P(B|A)P(A) \\
P(A,B)=P(A|B)P(B)
$$

#### 1.3 先验概率后验概率

先验概率是根据经验知识得到的概率，比如$P(下雨)$

后验概率是根据已经发生的事件得出的概率，比如$P(打雷后下雨)$

贝叶斯定理就是：

后验概率=先验概率*条件因子

### 2. 朴素贝叶斯

#### 2.1 两个假设

1. 特征独立性假设，所有输入特征均独立
2. 所有样本符合同一个联合概率分布$p(\vec{x},y)$

#### 2.2 朴素贝叶斯

##### 问题

给定数据集$\mathcal{D}=\{(\vec{x_1}, y_1),(\vec{x_2}, y_2)...(\vec{x_N}, y_N)\}, y\in\{c_1,c_2,..,c_n\}$，得到模型$f(\vec{x})$

##### 模型

贝叶斯定理
$$
p(y|\vec{x})=p(y)\frac{p(\vec{x}|y)}{p(\vec{x})}
$$

根据$\vec{x}$的特征独立性
$$
p(y|\vec{x})=p(y)\frac{\prod_{i=1}^{n}{p(x_i|y)}}{p(\vec{x})}
$$
根据全概率公式
$$
p(y|\vec{x})=p(y)\frac{\prod_{i=1}^{n}{p(x_i|y)}}{\sum_{y'}{p(\vec{x}|y')p(y')}}
$$
那么最终模型为
$$
f(\vec{x})=\arg\max_{y}p(y)\frac{\prod_{i=1}^{n}{p(x_i|y)}}{\sum_{y'}{p(\vec{x}|y')p(y')}}
$$

##### 优化过程

略去

#### 2.3 优缺点

优点：

性能好，速度快

缺点：

假设太强